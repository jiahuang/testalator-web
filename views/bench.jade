extends layout

block head
  script
    var socket = io.connect();
    var bench = "#{bench}";
    var gitLink = "https://github.com/technicalmachine/ScriptStick/tree/";
    socket.on('device_update', function (device) {
      // check if this is the right bench
      console.log("Got some data: ", device);
      if (device.bench != bench) return;
      // otherwise insert a new row
      var tbl = $("#device_table");
      tbl.prepend($('<tr>')
        .append($('<td>').text(device.built))
        .append($('<td>').text(device.id))
        .append($('<td>')
          .append($('<a>').attr('href', gitLink+device.firmware).text(device.firmware)
          ))
        .append($('<td>').text(device.tiFirmware))
        .append($('<td>').text(device.adc))
        .append($('<td>').text(device.spi))
        .append($('<td>').text(device.i2c))
        .append($('<td>').text(device.gpio))
        .append($('<td>').text(device.ram))
        .append($('<td>').text(device.wifi))
      );
    }); 

block content
  .row
    h2 #{bench} | Programming bench

  h2 Devices programmed
  #tessels
    table
      thead
        tr
          th Time
          th Device ID
          th Build
          th TI Firmware
          th ADC test
          th SPI test
          th I2C test
          th GPIOs test
          th RAM test
          th WiFi test
      tbody(id="device_table")
        each device in devices
          tr
            td=device.built
            td
              a(href="/d/#{device.id}")
                =device.id
            td
              a(href="https://github.com/technicalmachine/ScriptStick/tree/#{device.firmware}")
                =device.firmware
            td=device.tiFirmware
            td=device.adc
            td=device.spi
            td=device.i2c
            td=device.gpio
            td=device.ram
            td=device.wifi

